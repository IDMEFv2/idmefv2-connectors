# IDMEFv2 wazuh connector

This directory contains Python implementation of IDMEFv2 Wazuh (https://wazuh.com/) connector.

## Overview

The Wazuh connector uses the Wazuh JSON alerts stored in `/var/ossec/logs/alerts/alerts.json` by default (see https://documentation.wazuh.com/current/user-manual/manager/alert-management.html).

When an alert is generated by Wazuh, a new JSON record will be appended to the `alerts.json` file. This record will be analyzed by the connector and converted to a IDMEFv2 alert that will be uploaded to a IDMEFv2 server (either the testserver or the Concerto SIEM).

## Configuration

The connector uses a INI configuration file; a specific part for Wazuh provides the location of the `alerts.json` file. An example of configuration file is given in [wazuh-idmefv2.sample.conf](./wazuh-idmefv2.sample.conf).

Example of Wazuh connector configuration file:

``` ini
[logging]
# Logging level: change to DEBUG for more information, INFO for less information
level = DEBUG
# level = INFO

[idmefv2]
# URL of server to POST IDMEFv2 alerts
url = http://testserver.idmefv2:9999

[wazuh]
# Location of wazuh log file
logfile=/var/ossec/logs/alerts/alerts.json
```

## Running

The `idmefv2.connectors.wazuh` Python module can be run directly. The only mandatory command line argument is the path of the configuration file.

``` sh
python3 -m idmefv2.connectors.wazuh -c /etc/wazuh-idmefv2.conf
```
